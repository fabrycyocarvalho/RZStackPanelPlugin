rz.plugins.StackPanelPlugin=function(params){var helpers={defaultitemRenderer:{render:function(data,sender){var sb=new StringBuilder;return sb.appendFormat('<div id="{0}_item_{1}" class="{3}">{2}</div>',sender.params.baseID,generateRandomID(),data,sender.params.stackItemClass),sb.toString()},initialize:void 0},defaultEventHandlers:{afterRender:void 0,beforeRender:void 0,buildingContent:void 0}},$this=this,initialize=function(){var defaultParams={orientation:"vertical",verticalContainerStyle:"ui vertical fluid menu",horizontalContainerStyle:"ui menu",target:"div .rutezangada-stack-panel-container",baseID:generateRandomID(),itemRenderer:helpers.defaultitemRenderer,eventHandlers:helpers.defaultEventHandlers,stackItemClass:"draggable item",sortParams:{group:params.target.replace("#",""),containerSelector:"div.tab-container",itemSelector:"div.item",placeholder:'<div class="placeholder"></div>',delay:300,vertical:!0,isValidTarget:function($item,container){return!($this.movingContainer&&container.target.hasClass("subgroup"))},onDragStart:function($item,container){$item.css({height:$item.outerHeight(),width:$item.outerWidth()}),$item.addClass(container.group.options.draggedClass),$("body").addClass(container.group.options.bodyClass),$this.movingContainer=$item.hasClass("sub-container")}}};$this.params=$.extend(!0,{},defaultParams,params),render()},resolveContainerClass=function(){var params=$this.params;return"vertical"==params.orientation?params.verticalContainerStyle+" rz-vertical-stackpanel":params.horizontalContainerStyle+" rz-horizontal-stackpanel"},raiseEvent=function(event,args){$this.params.eventHandlers[event]&&$this.params.eventHandlers[event]($this,args)},render=function(){var params=$this.params,sb=new StringBuilder;raiseEvent("beforeRender"),sb.appendFormat('<div id="{0}" class="{1} tab-container rutezangada-stack-panel-container">',params.baseID,resolveContainerClass()),raiseEvent("buildingContent"),sb.appendFormat("</div>"),$(params.target).html(sb.toString());var p=params.sortParams;p.vertical="vertical"==params.orientation,$("#"+params.baseID).sortable(p),raiseEvent("afterRender")},resolveItemRenderer=function(r){if(void 0===r)return $this.params.itemRenderer;if("string"==typeof r)throw"not implemented yet";return r},plotItem=function(el,pos){if(void 0===pos)el.appendTo("#"+$this.params.baseID);else{var refItem=$("#"+$this.params.baseID).children()[pos];void 0!==refItem?el.insertBefore(refItem):el.appendTo("#"+$this.params.baseID)}};this.addItem=function(itemData,customrender,done){done=rz.helpers.ensureFunction(done);var itemRenderer=resolveItemRenderer(customrender),html=itemRenderer.render(itemData,$this),el=$(html);plotItem(el),itemRenderer.initialize&&itemRenderer.initialize(itemData,$this,el),done($this,{element:el})},this.insertItem=function(itemData,pos,customrender,done){done=rz.helpers.ensureFunction(done);var itemRenderer=resolveItemRenderer(customrender),html=itemRenderer.render(itemData,$this),el=$(html);plotItem(el,pos),itemRenderer.initialize&&itemRenderer.initialize(itemData,$this,el),done($this,{element:el})},this.removeItem=function(selector){$("#"+$this.params.baseID).children(selector).detach()},this.removeItemAt=function(pos){$($("#"+$this.params.baseID).children()[pos]).detach()},initialize()};